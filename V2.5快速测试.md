# V2.5 快速测试指南 ⚡

## 🎯 **1分钟快速测试**

### **测试1：无边框窗口**

✅ **步骤**：
1. 启动应用
2. 观察窗口顶部

✅ **预期结果**：
- ❌ 没有Windows系统标题栏（蓝色/灰色边框）
- ✅ 有黑色自定义标题栏，显示 "FloatSort"
- ✅ 右侧有 ➖ 和 ✕ 两个按钮

---

### **测试2：标题栏功能**

✅ **拖动窗口**：
1. 鼠标放在黑色标题栏上
2. 按住左键拖动
3. **预期**：窗口跟随鼠标移动

✅ **最小化按钮**：
1. 点击 ➖ 按钮
2. **预期**：进入Mini模式（300×300黑色窗口）

✅ **关闭按钮**：
1. 点击 ✕ 按钮
2. **预期**：应用关闭

---

### **测试3：Mini窗口自动折叠**

#### **步骤**：

1. **进入Mini模式**
   - 点击标题栏 ➖ 按钮
   - 或点击右上角原有的 ➖ 按钮

2. **拖动到左边缘**
   - 拖动Mini窗口到屏幕左边缘
   - 确保窗口距离边缘 < 50像素

3. **触发折叠**
   - 鼠标移出Mini窗口区域
   - **预期**：窗口向左滑动，只露出右侧10%
   - **动画**：平滑滑动，耗时0.3秒

4. **自动展开**
   - 鼠标移到屏幕左边缘（折叠的窗口位置）
   - **预期**：窗口自动展开

5. **点击行为**
   - **折叠状态下点击**：仅展开，不退出
   - **展开状态下点击**：返回完整界面

---

### **测试4：批量确认阈值**

#### **阈值=1（默认）**

✅ **步骤**：
1. 准备 1个测试文件（如 `test.jpg`）
2. 拖拽到窗口
3. **预期**：
   - ✅ 立即弹出批量确认窗口
   - ✅ 显示文件名、原始路径、目标路径
   - ✅ 点击"确认整理"后文件移动

#### **阈值=0（禁用批量确认）**

✅ **步骤**：
1. 打开 `data/config.json`
2. 修改 `"batch_threshold": 0`
3. 保存并重启应用
4. 拖拽任意文件
5. **预期**：
   - ✅ 不弹窗
   - ✅ 直接整理文件
   - ✅ 活动日志显示整理结果

---

## 🎨 **视觉检查清单**

### **自定义标题栏**
- [ ] 标题栏为黑色背景
- [ ] "FloatSort" 文字为白色
- [ ] ➖ 和 ✕ 按钮为白色
- [ ] 鼠标悬停按钮，背景变为半透明白色
- [ ] 标题栏高度约32像素

### **Mini窗口折叠**
- [ ] 折叠动画流畅（0.3秒过渡）
- [ ] 折叠后只露出10%
- [ ] 展开时完全显示
- [ ] 鼠标移到边缘自动展开
- [ ] 鼠标离开自动折叠

---

## 🐛 **问题排查**

### **问题1：标题栏没有消失**

**可能原因**：配置未生效  
**检查**：
```bash
# 确认 tauri.conf.json
"decorations": false  # 应该是 false
```

**解决方案**：
1. 确认配置文件正确
2. 完全重启应用（`cargo run`）
3. 清理缓存：`cargo clean`

---

### **问题2：Mini窗口不折叠**

**可能原因**：窗口未靠近边缘  
**检查**：
- 窗口是否距离屏幕边缘 < 50像素？
- 控制台是否有错误？

**调试**：
```javascript
// 在控制台输入
console.log('窗口位置:', await window.__TAURI__.window.appWindow.outerPosition());
console.log('屏幕尺寸:', window.screen.width, window.screen.height);
```

**预期位置（左边缘）**：
- `position.x <= 50`

---

### **问题3：批量确认阈值未生效**

**可能原因**：配置文件未保存或格式错误  
**检查**：
```json
// data/config.json
{
  "batch_threshold": 1,  // ← 确认这一行存在且正确
  ...
}
```

**调试**：
```javascript
// 在控制台输入
console.log('当前阈值:', appState.batchThreshold);

// 如果显示错误的值，重新加载配置
await loadConfig();
console.log('重新加载后:', appState.batchThreshold);
```

---

## 🔧 **控制台调试命令**

### **查看当前状态**
```javascript
// 窗口模式
console.log('Mini模式:', appState.isMiniMode);
console.log('折叠状态:', appState.miniCollapsed);
console.log('折叠边缘:', appState.miniCollapseEdge);

// 批量阈值
console.log('批量阈值:', appState.batchThreshold);
```

### **手动控制折叠**
```javascript
// 手动折叠到左边缘
collapseMini('left');

// 手动展开
expandMini();

// 手动退出Mini模式
await exitMiniMode();
```

### **测试配置加载**
```javascript
// 重新加载配置
await loadConfig();
console.log('配置已重新加载');

// 查看完整配置
const config = await invoke('get_config');
console.log('完整配置:', config);
```

---

## 📊 **边缘检测测试**

### **测试左边缘**
```
1. 进入Mini模式
2. 拖动窗口到左边缘（几乎贴边）
3. 鼠标离开
4. 预期：向左折叠
5. 鼠标移到左边缘
6. 预期：向右展开
```

✅ **通过标准**：
- 折叠速度流畅
- 只露出10%右侧
- 鼠标移到边缘立即展开

### **测试右边缘**
```
重复上述步骤，但拖动到右边缘
预期：向右折叠，只露出左侧
```

### **测试上边缘**
```
重复上述步骤，但拖动到上边缘
预期：向上折叠，只露出底部
```

### **测试下边缘**
```
重复上述步骤，但拖动到下边缘
预期：向下折叠，只露出顶部
```

---

## 🎯 **完整测试流程**

### **流程1：从启动到折叠到整理**

```
1. 启动应用
   ✓ 黑色自定义标题栏显示

2. 点击标题栏 ➖
   ✓ 进入Mini模式

3. 拖动到屏幕左边缘
   ✓ 鼠标离开后自动折叠

4. 准备测试文件（test.jpg）

5. 拖拽文件到屏幕左边缘
   ✓ Mini窗口自动展开
   ✓ 显示当前规则

6. 松手放入文件
   ✓ 弹出批量确认窗口（阈值=1）
   ✓ 显示目标路径预览

7. 点击"确认整理"
   ✓ 文件移动到目标位置
   ✓ 活动日志显示记录

8. 鼠标离开
   ✓ Mini窗口再次折叠

9. 鼠标移到左边缘，点击展开的窗口
   ✓ 返回完整界面
```

---

## ✅ **测试完成确认**

完成以下所有项目后，功能即测试通过：

### **标题栏功能**
- [ ] 无系统标题栏
- [ ] 自定义黑色标题栏正常显示
- [ ] 标题栏可拖动窗口
- [ ] ➖ 按钮进入Mini模式
- [ ] ✕ 按钮关闭应用

### **Mini窗口折叠**
- [ ] 左边缘折叠/展开
- [ ] 右边缘折叠/展开
- [ ] 上边缘折叠/展开
- [ ] 下边缘折叠/展开
- [ ] 折叠状态点击只展开
- [ ] 展开状态点击退出Mini模式

### **批量确认阈值**
- [ ] 阈值=1时，1个文件弹窗
- [ ] 阈值=0时，不弹窗直接整理
- [ ] 阈值从配置正确加载
- [ ] 修改配置后重启生效

---

## 🚀 **性能检查**

### **动画流畅度**
- [ ] 折叠动画无卡顿（0.3秒）
- [ ] 展开动画无卡顿（0.3秒）
- [ ] 鼠标移动响应及时（<100ms）

### **窗口操作**
- [ ] 拖动窗口流畅
- [ ] 进入Mini模式快速（<500ms）
- [ ] 退出Mini模式快速（<500ms）

---

## 📸 **建议截图**

1. **完整界面 + 自定义标题栏**
2. **Mini模式展开状态**
3. **Mini模式折叠状态（左边缘）**
4. **批量确认窗口（阈值=1）**
5. **活动日志显示整理记录**

---

**祝测试顺利！** 🎉

如有问题，请查看 `V2.5功能更新说明.md` 获取详细文档。

