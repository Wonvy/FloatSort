# FloatSort 用户指南

## 📖 目录

- [快速开始](#快速开始)
- [界面介绍](#界面介绍)
- [功能详解](#功能详解)
- [规则配置](#规则配置)
- [常见场景](#常见场景)
- [常见问题](#常见问题)

## 快速开始

### 安装

1. **下载应用**
   - 从 [Releases](https://github.com/yourusername/FloatSort/releases) 页面下载对应平台的安装包
   - Windows: `.msi` 文件
   - macOS: `.dmg` 文件
   - Linux: `.deb` 或 `.AppImage` 文件

2. **安装应用**
   - **Windows**: 双击 `.msi` 文件，按提示安装
   - **macOS**: 打开 `.dmg` 文件，拖拽到应用程序文件夹
   - **Linux**: `sudo dpkg -i floatsort_*.deb` 或直接运行 `.AppImage`

3. **首次运行**
   - 启动 FloatSort
   - 配置监控路径
   - 自定义整理规则
   - 开始监控

### 5 分钟入门

1. **添加监控文件夹**
   ```
   点击"设置" → "监控路径" → "添加路径"
   选择下载文件夹（如：C:\Users\你的用户名\Downloads）
   ```

2. **启用默认规则**
   - 应用已包含常用文件类型规则（图片、文档、视频等）
   - 默认规则已启用，无需额外配置

3. **开始监控**
   ```
   点击"开始监控"按钮
   下载新文件将自动整理
   ```

## 界面介绍

### 主界面布局

```
┌─────────────────────────────────────┐
│  FloatSort          ● 监控中         │
├─────────────────────────────────────┤
│  ┌─────────┐  ┌─────────┐          │
│  │开始监控 │  │  设置   │          │
│  └─────────┘  └─────────┘          │
├─────────────────────────────────────┤
│                                     │
│      拖拽文件到此处快速整理          │
│                                     │
├─────────────────────────────────────┤
│  已处理文件: 42   已整理文件: 38    │
├─────────────────────────────────────┤
│  最近活动                           │
│  ○ 12:30 - 图片已整理               │
│  ○ 12:25 - 文档已移动               │
└─────────────────────────────────────┘
```

### 界面元素说明

| 元素 | 说明 |
|------|------|
| 状态指示器 | 显示当前监控状态（监控中/未监控） |
| 开始/停止监控 | 切换文件监控状态 |
| 设置按钮 | 打开设置面板 |
| 拖拽区域 | 拖拽文件到此区域进行手动整理 |
| 统计卡片 | 显示处理和整理的文件数量 |
| 活动日志 | 显示最近的文件整理记录 |

## 功能详解

### 1. 自动监控

**工作原理**：
- 监控指定文件夹的文件变化
- 新文件创建时自动触发规则匹配
- 根据匹配的规则执行整理动作

**使用步骤**：
1. 添加要监控的文件夹路径
2. 配置整理规则
3. 点击"开始监控"
4. 应用会在后台自动工作

**注意事项**：
- 监控是实时的，新文件会立即处理
- 应用需要有目标文件夹的读写权限
- 监控多个文件夹不会明显影响性能

### 2. 手动整理

**使用方法**：
- 直接拖拽文件到悬浮窗的拖拽区域
- 应用会立即应用规则并整理文件
- 支持同时拖拽多个文件

**适用场景**：
- 整理已存在的旧文件
- 临时处理某个特定文件
- 测试规则是否正确工作

### 3. 规则系统

#### 规则结构

每条规则包含：
- **名称**：规则的描述性名称
- **启用状态**：规则是否生效
- **条件**：文件需要满足的条件（可多个）
- **动作**：满足条件后执行的操作
- **优先级**：数字越小优先级越高

#### 条件类型

| 条件类型 | 说明 | 示例 |
|---------|------|------|
| 扩展名 | 文件扩展名匹配 | `jpg`, `pdf`, `mp3` |
| 文件大小 | 文件大小范围（字节） | 最小: 1MB, 最大: 100MB |
| 名称包含 | 文件名包含特定文本 | 包含"报告" |
| 正则表达式 | 文件名匹配正则 | `^IMG_\d{4}\.jpg$` |
| 创建时间 | 文件创建后的天数 | 最近 7 天 |
| 修改时间 | 文件修改后的天数 | 90 天前 |

#### 动作类型

| 动作 | 说明 | 示例 |
|------|------|------|
| 移动到 | 移动文件到指定文件夹 | `Pictures` |
| 复制到 | 复制文件到指定文件夹 | `Backup/Documents` |
| 重命名 | 按模板重命名文件 | `{name}_backup.{ext}` |
| 删除 | 删除文件（谨慎使用） | - |

### 4. 统计功能

应用会实时统计：
- **已处理文件数**：检查过的文件总数
- **已整理文件数**：成功整理的文件数

### 5. 活动日志

显示最近的文件操作记录：
- 时间戳
- 操作类型（整理成功/失败）
- 文件信息
- 保留最近 10 条记录

## 规则配置

### 创建新规则

1. 打开设置面板
2. 在"整理规则"部分点击"添加规则"
3. 配置规则参数
4. 保存设置

### 规则示例

#### 示例 1：整理图片文件

```json
{
  "name": "图片文件归类",
  "enabled": true,
  "conditions": [
    {
      "type": "Extension",
      "values": ["jpg", "png", "gif", "webp"]
    }
  ],
  "action": {
    "type": "MoveTo",
    "destination": "Pictures"
  },
  "priority": 1
}
```

#### 示例 2：大文件归档

```json
{
  "name": "大文件归类",
  "enabled": true,
  "conditions": [
    {
      "type": "SizeRange",
      "min": 104857600,  // 100MB
      "max": null
    }
  ],
  "action": {
    "type": "MoveTo",
    "destination": "LargeFiles"
  },
  "priority": 10
}
```

#### 示例 3：旧文件清理

```json
{
  "name": "清理旧临时文件",
  "enabled": true,
  "conditions": [
    {
      "type": "NameContains",
      "pattern": "temp"
    },
    {
      "type": "ModifiedDaysAgo",
      "min": 30,
      "max": null
    }
  ],
  "action": {
    "type": "Delete"
  },
  "priority": 20
}
```

### 规则优先级

- 数字越小，优先级越高
- 文件匹配到第一个符合条件的规则后停止匹配
- 建议：具体规则设置较高优先级，通用规则设置较低优先级

**优先级设置建议**：
```
1-10:   特定文件类型（图片、文档等）
11-20:  基于大小的规则
21-30:  基于时间的规则
31+:    通用规则和清理规则
```

## 常见场景

### 场景 1：整理下载文件夹

**需求**：自动将下载的文件按类型分类

**配置**：
1. 监控路径：`C:\Users\你的用户名\Downloads`
2. 启用默认规则（图片、文档、视频、音频等）
3. 开始监控

**效果**：
- 图片 → `Downloads\Pictures`
- 文档 → `Downloads\Documents`
- 视频 → `Downloads\Videos`

### 场景 2：工作项目文件管理

**需求**：按项目名称整理文件

**配置**：
```json
{
  "name": "项目A文件",
  "conditions": [
    {"type": "NameContains", "pattern": "ProjectA"}
  ],
  "action": {
    "type": "MoveTo",
    "destination": "Projects/ProjectA"
  }
}
```

### 场景 3：照片按日期归档

**需求**：自动归档旧照片

**配置**：
```json
{
  "name": "归档旧照片",
  "conditions": [
    {"type": "Extension", "values": ["jpg", "png"]},
    {"type": "CreatedDaysAgo", "min": 90}
  ],
  "action": {
    "type": "MoveTo",
    "destination": "Archive/Photos/Old"
  }
}
```

### 场景 4：清理临时文件

**需求**：定期清理下载的临时文件

**配置**：
```json
{
  "name": "清理临时文件",
  "conditions": [
    {"type": "Extension", "values": ["tmp", "temp", "cache"]},
    {"type": "ModifiedDaysAgo", "min": 7}
  ],
  "action": {"type": "Delete"}
}
```

## 常见问题

### Q1: 文件被移动到错误的位置？

**A**: 检查规则优先级。优先级高的规则会先匹配，可能导致文件被错误归类。调整规则优先级或添加更具体的条件。

### Q2: 监控不工作？

**A**: 
1. 检查监控路径是否正确
2. 确认应用有读写权限
3. 查看活动日志是否有错误信息
4. 重启应用尝试

### Q3: 文件被意外删除？

**A**: 
1. 检查是否有 `Delete` 动作的规则
2. 禁用不确定的规则
3. 先用 `MoveTo` 测试规则
4. Windows 用户可从回收站恢复

### Q4: 如何备份配置？

**A**: 配置文件位于：
- Windows: `用户目录\AppData\Roaming\com.floatsort.app\data\config.json`
- macOS: `~/Library/Application Support/com.floatsort.app/data/config.json`
- Linux: `~/.config/com.floatsort.app/data/config.json`

复制此文件即可备份。

### Q5: 应用占用内存/CPU 过高？

**A**: 
1. 减少监控的文件夹数量
2. 简化复杂的正则表达式规则
3. 关闭不必要的通知
4. 重启应用

### Q6: 如何处理重复文件名？

**A**: 当目标位置存在同名文件时：
- 默认行为：操作失败，记录错误
- 建议：在规则中使用 `Rename` 动作添加时间戳

### Q7: 可以恢复已整理的文件吗？

**A**: 
- 应用本身不提供撤销功能
- 建议在测试规则时先使用 `CopyTo` 而不是 `MoveTo`
- 使用文件管理器的历史记录功能

### Q8: 支持网络驱动器吗？

**A**: 支持，但可能存在性能问题。网络延迟可能导致文件监控不稳定。

## 技巧和最佳实践

1. **先测试后部署**：使用复制动作测试新规则
2. **定期检查日志**：确保规则按预期工作
3. **备份重要文件**：在使用删除动作前备份
4. **合理设置优先级**：避免规则冲突
5. **使用描述性名称**：便于管理和维护规则
6. **保守使用删除**：优先使用移动到临时文件夹

## 获取帮助

- 📖 [完整文档](https://github.com/yourusername/FloatSort/wiki)
- 🐛 [报告问题](https://github.com/yourusername/FloatSort/issues)
- 💬 [讨论区](https://github.com/yourusername/FloatSort/discussions)
- 📧 Email: support@floatsort.example.com

