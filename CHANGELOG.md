# 更新日志

本文档记录 FloatSort 项目的所有重要更改。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
版本号遵循 [语义化版本](https://semver.org/lang/zh-CN/)。

## [未发布]

### 计划添加
- 规则编辑器 UI
- 规则导入/导出功能
- 多语言支持（英文）
- 文件预览功能
- 批量操作工具

### 计划修改
- 优化大文件处理性能
- 改进错误提示信息
- 增强日志记录

## [0.2.0] - 2025-10-30

### ✨ 新增

#### 正则表达式捕获组功能
- 🎯 **正则捕获组支持**：在正则表达式中使用 `()` 创建捕获组
- 📂 **动态路径引用**：在目标路径中使用 `$1`, `$2`, `$3` 引用捕获内容
- 💡 **两种使用模式**：
  - 模式1：只用正则（精确控制）- 正则表达式包含扩展名
  - 模式2：扩展名 + 简化正则（推荐）- 扩展名独立管理
- 📖 **完整文档**：新增 `REGEX_CAPTURE_GUIDE.md` 详细使用指南
- 🎨 **UI 优化**：正则表达式输入框增加详细使用说明和示例
- 🏷️ **快捷按钮**：目标路径占位符区新增 `$1`~`$4` 快捷插入按钮

#### 时间条件增强
- 📅 **绝对时间支持**：支持指定具体日期和时间（如：2024-01-01 之前/之后）
- ⏰ **相对时间支持**：支持预设时间段（最近1天、3天、7天、30天等）
- 🔧 **自定义天数**：支持自定义相对时间天数
- 🎯 **灵活比较**：支持"之前"和"之后"两种比较方式

#### 规则管理优化
- 🔼🔽 **规则排序优化**：编辑文件夹中的关联规则支持上下移动
- ✏️ **快速编辑按钮**：关联规则列表添加快速编辑按钮，直接跳转到规则编辑
- 🗑️ **删除按钮**：支持从文件夹关联中快速移除规则（带确认对话框）
- 🎨 **按钮样式统一**：排序按钮改为水平布局，使用 SVG 图标，与规则列表风格一致

#### 条件管理改进
- 🚫 **防止重复条件**：同一类型的条件只能添加一次（如：只能有一个"修改时间"条件）
- 💡 **智能提示**：尝试添加重复条件时显示错误提示
- 🔄 **类型检查优化**：兼容新旧时间条件类型

### 🛠️ 改进

#### 代码质量
- ✅ **修复编译警告**：删除未使用的 `check_conditions` 函数
- ✅ **生命周期优化**：明确指定 `RuleMatch` 结构体的生命周期参数
- ✅ **类型安全**：为 `RuleMatch` 添加 `Debug` trait

#### 日志系统
- 📝 **活动日志持久化修复**：修复清空日志后自动恢复的问题
- 🗑️ **后端日志清理**：新增 `clear_activity_logs` 命令清空持久化日志文件
- 📅 **时间戳格式**：活动日志时间戳改为完整格式（YYYY-MM-DD HH:MM:SS）
- 📈 **日志容量扩展**：日志保留数量从 100 增加到 200 条

### 📚 文档

#### 新增文档
- 📖 **正则捕获组指南**：`REGEX_CAPTURE_GUIDE.md` - 详细使用说明和示例
- 🎯 **实用示例**：包含 5 个实际应用场景（日期归档、项目编号、客户分类、版本号、模式对比）
- 📝 **正则语法参考**：常用元字符、捕获组、数量限定符等

#### 文档优化
- ✅ **功能说明完善**：界面内嵌详细的正则捕获组使用说明
- ⚠️ **注意事项**：明确指出正则匹配包含扩展名的完整文件名
- 💡 **最佳实践**：推荐使用"扩展名 + 简化正则"模式

### 🐛 修复

- 🔧 **变量名错误修复**：修复 `addCondition()` 中 `conditionType` 到 `type` 的变量名错误
- 🔄 **API 更新**：更新所有使用旧 API 的地方以支持正则捕获组
- ✅ **兼容性修复**：保留旧的时间条件类型以保证向后兼容

## [0.1.0] - 2025-10-28

### ✨ 新增

#### 核心功能
- 🎯 实时文件监控系统（基于 notify crate）
- 🔧 智能规则引擎（支持多条件判断）
- 📁 文件自动整理（移动、复制、重命名、删除）
- 🖱️ 拖拽文件快速整理
- 📊 实时统计和活动日志

#### 规则系统
- ✅ 扩展名匹配条件
- ✅ 文件大小范围条件
- ✅ 文件名包含条件
- ✅ 正则表达式匹配
- ✅ 创建时间条件
- ✅ 修改时间条件
- ✅ 规则优先级支持

#### 用户界面
- 🎨 现代化深色主题
- 💫 流畅动画效果
- 📱 响应式布局
- ⚙️ 侧边设置面板
- 📈 实时统计卡片
- 📝 活动日志显示

#### 配置系统
- 💾 JSON 配置文件
- 🔄 配置热重载
- 📋 默认规则模板
- ✏️ 监控路径管理

#### 文档
- 📖 完整的 README
- 🚀 快速开始指南
- 👨‍💻 开发者文档
- 🏗️ 构建指南
- 👥 贡献指南
- 📚 详细用户手册

#### 开发工具
- 🛠️ Windows 开发启动脚本 (dev.ps1)
- 🛠️ Linux/macOS 开发脚本 (dev.sh)
- 📦 Windows 构建脚本 (build.ps1)
- 📦 Linux/macOS 构建脚本 (build.sh)

#### 默认规则
- 📷 图片文件自动归类（jpg, png, gif 等）
- 📄 文档文件自动归类（pdf, doc, txt 等）
- 🎬 视频文件自动归类（mp4, avi, mkv 等）
- 🎵 音频文件自动归类（mp3, wav, flac 等）
- 📦 压缩包自动归类（zip, rar, 7z 等）

### 🔧 技术栈

- Rust 2021 Edition
- Tauri 1.5
- notify 6.1（文件监控）
- serde + serde_json（序列化）
- tracing（日志系统）
- tokio（异步运行时）
- HTML5 + CSS3 + ES6+（前端）

### 📦 发布格式

- Windows: MSI 安装包
- macOS: DMG 磁盘映像
- Linux: DEB 包 / AppImage

### 🎯 性能指标

- 内存占用：15-30 MB（空闲/监控）
- CPU 占用：0-2%（空闲/监控）
- 启动时间：< 2 秒
- 安装包大小：6-12 MB（各平台）

### 🔐 安全性

- Tauri 安全沙箱环境
- 文件操作权限控制
- 配置文件验证
- 路径遍历防护

### 📝 已知限制

- 暂不支持规则可视化编辑器
- 暂不支持配置导入/导出
- 暂不支持多语言界面
- 暂不支持文件预览

### 🐛 已知问题

- 无重大已知问题

---

## 版本说明

### 版本号格式

使用语义化版本号：`主版本号.次版本号.修订号`

- **主版本号**：不兼容的 API 修改
- **次版本号**：向下兼容的功能性新增
- **修订号**：向下兼容的问题修正

### 更新类型说明

- **新增 (Added)**：新功能
- **修改 (Changed)**：已有功能的变更
- **弃用 (Deprecated)**：即将移除的功能
- **移除 (Removed)**：已移除的功能
- **修复 (Fixed)**：Bug 修复
- **安全 (Security)**：安全性修复

---

[未发布]: https://github.com/Wonvy/FloatSort/compare/v0.1.0...HEAD
[0.1.0]: https://github.com/Wonvy/FloatSort/releases/tag/v0.1.0

